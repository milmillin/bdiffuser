@import "tailwindcss";

:root {
  --color-bomb-red: #e53e3e;
  --color-bomb-blue: #3182ce;
  --color-bomb-yellow: #ecc94b;
  --color-bomb-dark: #1a1a2e;
  --color-bomb-surface: #2d2d44;
  --color-bomb-accent: #e94560;
}

html,
body,
#root {
  width: 100%;
  height: 100%;
}

body {
  margin: 0;
  background: var(--color-bomb-dark);
  color: white;
  font-family: system-ui, -apple-system, sans-serif;
  min-height: 100dvh;
  overscroll-behavior: none;
}

html.ios-standalone-pwa,
html.ios-standalone-pwa body,
html.ios-standalone-pwa #root {
  height: auto;
  min-height: 100%;
}

html.ios-standalone-pwa body {
  min-height: 100dvh;
  overflow-x: hidden;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.safe-screen {
  padding-top: env(safe-area-inset-top);
  padding-right: env(safe-area-inset-right);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
}

img {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  -webkit-user-drag: none;
}

@media (prefers-reduced-motion: no-preference) {
  .forced-attention-pulse {
    animation: forced-attention-pulse 1.6s ease-in-out infinite;
  }
}

@keyframes forced-attention-pulse {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.18);
  }
  50% {
    box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.3);
  }
}

/* Wire tile flip animation */
.tile-flip {
  transition: transform 0.6s;
  transform-style: preserve-3d;
}

.tile-flip.flipped {
  transform: rotateY(180deg);
}

.tile-front,
.tile-back {
  backface-visibility: hidden;
  position: absolute;
  inset: 0;
}

.tile-back {
  transform: rotateY(180deg);
}

/* ═══════════════════════════════════════════════════
   EXPLOSION EFFECT — MEME-SIZED looping bomb (4s)
   ═══════════════════════════════════════════════════ */

/* Container — HUGE, overflows everything */
.explosion-container {
  position: relative;
  width: 100%;
  height: 420px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: visible;
}

/* ── SVG canvas — MASSIVE ── */
.explosion-center {
  position: absolute;
  width: 600px;
  height: 600px;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  animation: shake-loop 4s ease-in-out infinite;
}
.explosion-svg {
  width: 100%;
  height: 100%;
  overflow: visible;
}

/* ── DRAMATIC screen shake (30–45%) ── */
@keyframes shake-loop {
  0%, 29% { transform: translate(-50%, -50%); }
  30%  { transform: translate(calc(-50% + 18px), calc(-50% - 15px)); }
  31%  { transform: translate(calc(-50% - 22px), calc(-50% + 20px)); }
  32%  { transform: translate(calc(-50% + 25px), calc(-50% - 18px)); }
  33%  { transform: translate(calc(-50% - 20px), calc(-50% + 22px)); }
  34%  { transform: translate(calc(-50% + 16px), calc(-50% - 25px)); }
  35%  { transform: translate(calc(-50% - 24px), calc(-50% + 14px)); }
  36%  { transform: translate(calc(-50% + 20px), calc(-50% - 20px)); }
  37%  { transform: translate(calc(-50% - 15px), calc(-50% + 18px)); }
  38%  { transform: translate(calc(-50% + 18px), calc(-50% - 12px)); }
  39%  { transform: translate(calc(-50% - 12px), calc(-50% + 15px)); }
  40%  { transform: translate(calc(-50% + 10px), calc(-50% - 10px)); }
  41%  { transform: translate(calc(-50% - 8px), calc(-50% + 8px)); }
  42%  { transform: translate(calc(-50% + 5px), calc(-50% - 5px)); }
  43%  { transform: translate(calc(-50% - 3px), calc(-50% + 3px)); }
  45%, 100% { transform: translate(-50%, -50%); }
}

/* ── Bomb group lifecycle (fade in, pulse, vanish at detonation) ── */
.bomb-group {
  animation: bomb-lifecycle 4s ease-in-out infinite;
  transform-origin: 0 20px;
}
@keyframes bomb-lifecycle {
  0%   { opacity: 0; transform: scale(0.2); }
  3%   { opacity: 1; transform: scale(1.08); }
  5%   { transform: scale(0.97); }
  7%   { transform: scale(1); }
  14%  { transform: scale(1.04); }
  18%  { transform: scale(0.96); }
  22%  { transform: scale(1.06); }
  25%  { transform: scale(0.94); }
  27%  { transform: scale(1.08); }
  29%  { opacity: 1; transform: scale(1.12); }
  31%  { opacity: 0; transform: scale(1.3); }
  100% { opacity: 0; transform: scale(0); }
}

/* ── Fuse burn (stroke-dashoffset shrinks 0–28%) ── */
.fuse-line {
  stroke-dashoffset: 95;
  animation: fuse-burn 4s linear infinite;
}
@keyframes fuse-burn {
  0%   { stroke-dashoffset: 95; }
  28%  { stroke-dashoffset: 0; }
  30%, 100% { stroke-dashoffset: 0; }
}

/* ── Spark at fuse tip (rapid flickering 0–30%) ── */
.spark-glow {
  animation: spark-pulse 4s ease-in-out infinite;
}
@keyframes spark-pulse {
  0%     { r: 8;  opacity: 0; }
  5%     { r: 12; opacity: 0.9; }
  7%     { r: 6;  opacity: 0.5; }
  10%    { r: 15; opacity: 1; }
  12%    { r: 5;  opacity: 0.6; }
  15%    { r: 14; opacity: 0.9; }
  17%    { r: 7;  opacity: 0.5; }
  20%    { r: 16; opacity: 1; }
  22%    { r: 8;  opacity: 0.7; }
  25%    { r: 18; opacity: 1; }
  27%    { r: 10; opacity: 0.8; }
  29%    { r: 22; opacity: 1; }
  31%    { opacity: 0; r: 0; }
  100%   { opacity: 0; r: 0; }
}

/* ── Mini sparks flying off fuse tip ── */
.mini-spark {
  animation: mini-spark-fly 4s ease-out infinite;
}
@keyframes mini-spark-fly {
  0%, 5%   { opacity: 0; transform: translate(0, 0); }
  6%       { opacity: 0.9; }
  15%      { opacity: 0.7; transform: translate(var(--ms-tx), var(--ms-ty)); }
  20%      { opacity: 0; transform: translate(var(--ms-tx), var(--ms-ty)); }
  21%, 100% { opacity: 0; transform: translate(0, 0); }
}

/* ── Fireball — MASSIVE (expands 30–95%) ── */
.fireball-core {
  opacity: 0;
  animation: fireball-loop 4s ease-out infinite;
}
@keyframes fireball-loop {
  0%, 29% { r: 0;   opacity: 0; }
  32%  { r: 130; opacity: 1; }
  45%  { r: 170; opacity: 0.9; }
  60%  { r: 130; opacity: 0.6; }
  80%  { r: 60;  opacity: 0.3; }
  95%  { r: 15;  opacity: 0; }
  100% { r: 0;   opacity: 0; }
}

/* ── Fireball inner (white-hot center flash) ── */
.fireball-inner {
  opacity: 0;
  animation: fireball-inner-loop 4s ease-out infinite;
}
@keyframes fireball-inner-loop {
  0%, 29% { r: 0;  opacity: 0; }
  31%  { r: 70; opacity: 0.95; }
  40%  { r: 35; opacity: 0.5; }
  55%  { r: 8;  opacity: 0; }
  100% { r: 0;  opacity: 0; }
}

/* ── Shockwave rings (expand 30–65%) — HUGE radius ── */
.shockwave-ring {
  opacity: 0;
  animation: shockwave-loop 4s ease-out infinite;
}
@keyframes shockwave-loop {
  0%, 29%  { r: 10;  stroke-width: 6; opacity: 0; }
  31%      { r: 20;  opacity: 0.9; }
  50%      { r: 200; stroke-width: 2; opacity: 0.4; }
  65%      { r: 300; stroke-width: 0.5; opacity: 0; }
  100%     { r: 300; opacity: 0; }
}

/* ── Smoke blobs (billow outward 30–80%) ── */
.smoke-blob {
  opacity: 0;
  animation: smoke-loop 4s ease-out infinite;
}
@keyframes smoke-loop {
  0%, 29%  { transform: translate(0, 0) scale(1); opacity: 0; }
  35%      { opacity: 0.6; }
  55%      { opacity: 0.4; transform: translate(var(--smoke-tx), var(--smoke-ty)) scale(2.2); }
  80%      { transform: translate(var(--smoke-tx), var(--smoke-ty)) scale(3.5); opacity: 0; }
  100%     { opacity: 0; }
}

/* ── Bomb fragments (fly outward 30–80%) ── */
.bomb-fragment {
  opacity: 0;
  animation: fragment-fly 4s ease-out infinite;
}
@keyframes fragment-fly {
  0%, 29%  { transform: translate(0, 0) rotate(0deg); opacity: 0; }
  31%      { opacity: 1; }
  55%      { opacity: 0.7; }
  80%      { transform: translate(var(--frag-tx), var(--frag-ty)) rotate(var(--frag-rot)); opacity: 0; }
  100%     { opacity: 0; }
}

/* ── Particle field — originates from bomb center, overflows everywhere ── */
.particle-field {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  z-index: 50;
  pointer-events: none;
}

.particle {
  position: absolute;
  width: var(--size);
  height: var(--size);
  background: var(--color);
  border-radius: 50%;
  animation: particle-fly-loop 4s ease-out infinite;
  opacity: 0;
  box-shadow: 0 0 8px 2px var(--color);
}

.particle-spark {
  border-radius: 50%;
  box-shadow: 0 0 12px 4px var(--color);
}
.particle-ember {
  border-radius: 2px;
  box-shadow: 0 0 16px 4px var(--color);
}
.particle-debris {
  border-radius: 1px;
  box-shadow: 0 0 4px 1px rgba(100,100,100,0.5);
}

@keyframes particle-fly-loop {
  0%, 29% {
    transform: translate(0, 0) rotate(0deg) scale(1);
    opacity: 0;
  }
  31% {
    opacity: 1;
  }
  45% {
    opacity: 0.9;
  }
  65% {
    opacity: 0.5;
  }
  85% {
    transform: translate(var(--tx), var(--ty)) rotate(var(--spin)) scale(0.2);
    opacity: 0;
  }
  100% {
    transform: translate(var(--tx), var(--ty)) rotate(var(--spin)) scale(0);
    opacity: 0;
  }
}
